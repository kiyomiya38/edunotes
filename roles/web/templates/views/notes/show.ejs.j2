<%- include('../layout', { body: `
<a href="/notes">â† ä¸€è¦§ã¸æˆ»ã‚‹</a>
<h2 style="margin-bottom:0.2rem;">${n.title}</h2>
<p style="margin-top:0; opacity:.8;">
  by ${n.author_email}
  ï¼ ä½œæˆ: ${new Date(n.created_at).toLocaleString()}
  ï¼ æ›´æ–°: ${new Date(n.updated_at).toLocaleString()}
  ${n.is_public ? ' ï¼ ğŸŒ å…¬é–‹' : ''}
</p>

<section>
  <h3>æœ¬æ–‡</h3>
  <article style="border:1px solid #ddd; padding:1rem; border-radius:.5rem;">
    <%- n.body_html %>
  </article>
</section>

<section>
  <h3>ã‚¿ã‚°</h3>
  ${tags && tags.length ? `
    <p>${tags.map(t => `<span style="display:inline-block; padding:.1rem .5rem; border:1px solid #ccc; border-radius:999px; margin:.1rem;">#${t.name}</span>`).join(' ')}</p>
  ` : `<p>ï¼ˆã‚¿ã‚°ãªã—ï¼‰</p>`}

  <form method="post" action="/notes/${n.id}/tags" style="display:flex; gap:.5rem; align-items:center;">
    <input type="hidden" name="_csrf" value="${csrfToken}">
    <input name="name" placeholder="ã‚¿ã‚°åã‚’å…¥åŠ›">
    <button>è¿½åŠ </button>
  </form>
</section>

<section>
  <h3>ã‚³ãƒ¡ãƒ³ãƒˆ</h3>
  ${comments && comments.length ? `
    <ul>
      ${comments.map(c => `
        <li>
          <div style="opacity:.8; font-size:.95em;">
            ${c.author_email} ï¼ ${new Date(c.created_at).toLocaleString()}
          </div>
          <div style="border-left:3px solid #ddd; padding-left:.75rem; margin:.25rem 0 1rem;">
            <div><%- c.body_html %></div>
          </div>
        </li>
      `).join('')}
    </ul>
  ` : `<p>ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>`}

  <form method="post" action="/notes/${n.id}/comments">
    <input type="hidden" name="_csrf" value="${csrfToken}">
    <label>ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆMarkdownï¼‰
      <textarea name="body_md" rows="6" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆã‚’Markdownã§å…¥åŠ›"></textarea>
    </label>
    <button>ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿</button>
  </form>
</section>

<p style="margin-top:1.5rem;">
  <a href="/notes/${n.id}/edit">âœï¸ ç·¨é›†</a>
</p>
`, user, csrfToken }) %>

# ===== Base =====
NODE_ENV=production
PORT=3000

# ===== App =====
UPLOADS_DIR={{ (UPLOADS_DIR | default(lookup('env','UPLOADS_DIR'), true)) | default('/var/edunotes/uploads', true) }}
SESSION_SECRET={{ (SESSION_SECRET | default(lookup('env','SESSION_SECRET'), true)) | default('change-me-please', true) }}

# ===== DB (PostgreSQL) =====
DB_CLIENT=pg
DB_HOST={{ db_host | default((DB_HOST | default(lookup('env','DB_HOST'), true)), true) | default('REPLACE_DB_HOST', true) }}
DB_PORT={{ DB_PORT | default(lookup('env','DB_PORT'), true) | default('5432', true) }}
DB_NAME={{ db_name | default((DB_NAME | default(lookup('env','DB_NAME'), true)), true) | default('edunotes', true) }}
DB_USER={{ db_user | default((DB_USER | default(lookup('env','DB_USER'), true)), true) | default('edunotes_app', true) }}
DB_PASSWORD={{ db_pass | default((DB_PASSWORD | default(lookup('env','DB_PASSWORD'), true)), true) | default('REPLACE_DB_PASSWORD', true) }}
DATABASE_URL=postgres://{{ 
  (db_user | default(DB_USER | default(lookup('env','DB_USER'), true), true) | default('edunotes_app', true)) 
}}:{{
  (db_pass | default(DB_PASSWORD | default(lookup('env','DB_PASSWORD'), true), true) | default('REPLACE_DB_PASSWORD', true))
}}@{{
  (db_host | default(DB_HOST | default(lookup('env','DB_HOST'), true), true) | default('REPLACE_DB_HOST', true))
}}:{{
  (DB_PORT | default(lookup('env','DB_PORT'), true) | default('5432', true))
}}/{{
  (db_name | default(DB_NAME | default(lookup('env','DB_NAME'), true), true) | default('edunotes', true))
}}

# ===== Storage (Phase1) =====
STORAGE_MODE={{ storage_mode | default('s3') }}   # s3 or efs
AWS_REGION={{ aws_region | default('ap-northeast-3') }}
S3_BUCKET={{ s3_bucket_uploads | default('edunotes-uploads-bucket') }}
S3_PREFIX={{ s3_prefix_uploads | default('uploads/') }}
EFS_UPLOAD_DIR=/var/edunotes/uploads

# ===== Redis (Phase2で使用) =====
# USE_REDIS={{ (USE_REDIS | default(lookup('env','USE_REDIS'), true)) | default('false', true) }}
# REDIS_URL={{ (REDIS_URL | default(lookup('env','REDIS_URL'), true)) | default('', true) }}

# ===== S3/MinIO (Phase2で使用) =====
# STORAGE_BACKEND={{ (STORAGE_BACKEND | default(lookup('env','STORAGE_BACKEND'), true)) | default('', true) }}
# S3_ENDPOINT={{ (S3_ENDPOINT | default(lookup('env','S3_ENDPOINT'), true)) | default('', true) }}
# S3_BUCKET={{ (S3_BUCKET | default(lookup('env','S3_BUCKET'), true)) | default('', true) }}
# S3_ACCESS_KEY={{ (S3_ACCESS_KEY | default(lookup('env','S3_ACCESS_KEY'), true)) | default('', true) }}
# S3_SECRET_KEY={{ (S3_SECRET_KEY | default(lookup('env','S3_SECRET_KEY'), true)) | default('', true) }}
# S3_USE_PATH_STYLE={{ (S3_USE_PATH_STYLE | default(lookup('env','S3_USE_PATH_STYLE'), true)) | default('true', true) }}
